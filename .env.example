# PRPM Environment Configuration
# Copy this file to .env and fill in the values

# ==============================================================================
# DATABASE
# ==============================================================================

# PostgreSQL connection string
# Format: postgresql://user:password@host:port/database
DATABASE_URL=postgresql://prpm:password@localhost:5432/prpm

# Test database (optional - used for running tests)
TEST_DATABASE_URL=postgresql://prpm:password@localhost:5432/prpm_test

# ==============================================================================
# REDIS
# ==============================================================================

# Redis connection string for caching
REDIS_URL=redis://localhost:6379

# ==============================================================================
# S3 / STORAGE
# ==============================================================================

# S3-compatible storage for package tarballs
S3_ENDPOINT=http://localhost:9000
S3_REGION=us-east-1
S3_BUCKET=prpm-packages
S3_ACCESS_KEY_ID=minioadmin
S3_SECRET_ACCESS_KEY=minioadmin

# AWS region for production deployments
AWS_REGION=us-west-2

# ==============================================================================
# AUTHENTICATION
# ==============================================================================

# JWT secret for token signing (generate with: openssl rand -base64 32)
JWT_SECRET=your-jwt-secret-here-change-in-production

# JWT token expiration time
JWT_EXPIRES_IN=7d

# GitHub OAuth credentials
# Get from: https://github.com/settings/developers
GITHUB_CLIENT_ID=your-github-client-id
GITHUB_CLIENT_SECRET=your-github-client-secret
GITHUB_CALLBACK_URL=http://localhost:3111/api/v1/auth/github/callback

# Nango OAuth integration
# Get from: https://www.nango.dev/
NANGO_API_KEY=your-nango-api-key
NANGO_INTEGRATION_ID=github
NANGO_HOST=https://api.nango.dev

# ==============================================================================
# SERVER
# ==============================================================================

# Server configuration
NODE_ENV=development
HOST=0.0.0.0
PORT=3111
LOG_LEVEL=info

# Frontend URL (for CORS and redirects)
FRONTEND_URL=http://localhost:3001

# ==============================================================================
# SEARCH
# ==============================================================================

# Search engine: 'postgres' or 'opensearch'
SEARCH_ENGINE=postgres

# OpenSearch endpoint (optional - only if using OpenSearch)
# OPENSEARCH_ENDPOINT=https://search-prpm.us-west-2.es.amazonaws.com

# ==============================================================================
# AI FEATURES
# ==============================================================================

# Enable AI-powered quality evaluation (optional)
AI_EVALUATION_ENABLED=false

# Anthropic API key for AI evaluation and playground
# Get from: https://console.anthropic.com/
ANTHROPIC_API_KEY=sk-ant-api03-...

# OpenAI API key for playground (gpt-4o, gpt-4o-mini models)
# Get from: https://platform.openai.com/api-keys
OPENAI_API_KEY=sk-proj-...

# ==============================================================================
# TELEMETRY & ANALYTICS
# ==============================================================================

# Enable anonymous usage telemetry
ENABLE_TELEMETRY=true

# PostHog configuration for event tracking
# Get from: https://app.posthog.com/project/settings
# Download events are automatically sent to PostHog for analytics
POSTHOG_API_KEY=your-posthog-ingestion-key
POSTHOG_HOST=https://app.posthog.com

# ==============================================================================
# RATE LIMITING
# ==============================================================================

# Rate limit: max requests per window
RATE_LIMIT_MAX=100

# Rate limit window in milliseconds (default: 1 minute)
RATE_LIMIT_WINDOW=60000

# ==============================================================================
# STRIPE INTEGRATION
# ==============================================================================

# Stripe API keys
# Get from: https://dashboard.stripe.com/apikeys
STRIPE_SECRET_KEY=sk_test_...
STRIPE_PUBLISHABLE_KEY=pk_test_...

# Stripe webhook secret for signature verification
# Get from: https://dashboard.stripe.com/webhooks
STRIPE_WEBHOOK_SECRET=whsec_...

# Additional webhook secret for credit purchases (if separate endpoint)
STRIPE_WEBHOOK_SECRET_CREDITS=whsec_...

# Stripe price IDs for subscriptions
# Get from: https://dashboard.stripe.com/prices
STRIPE_VERIFIED_PLAN_PRICE_ID=price_...
STRIPE_PRPM_PLUS_PRICE_ID=price_...
STRIPE_PRPM_PLUS_ORG_MEMBER_PRICE_ID=price_...

# ==============================================================================
# PACKAGE VALIDATION
# ==============================================================================

# Maximum package size in bytes (default: 10MB)
MAX_PACKAGE_SIZE=10485760

# Allowed file extensions for packages (comma-separated)
ALLOWED_FILE_EXTENSIONS=.md,.txt,.json,.yaml,.yml

# ==============================================================================
# CLI CONFIGURATION
# ==============================================================================

# Registry URL for CLI to connect to
PRPM_REGISTRY_URL=http://localhost:3111
REGISTRY_URL=http://localhost:3111

# ==============================================================================
# WEBAPP (Next.js)
# ==============================================================================

# Public API URLs (must be accessible from browser)
NEXT_PUBLIC_API_URL=http://localhost:3111/api/v1
NEXT_PUBLIC_REGISTRY_URL=http://localhost:3111

# Site URL for SEO and metadata
NEXT_PUBLIC_SITE_URL=http://localhost:3001

# Stripe publishable key (public - safe to expose in browser)
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_...

# S3 URL for SEO data (if using pre-rendered SEO data)
# NEXT_PUBLIC_S3_SEO_DATA_URL=https://your-bucket.s3.amazonaws.com/seo

# Enable dev mode features in webapp
NEXT_PUBLIC_IS_LOCAL=true

# Webapp URL (used by backend for redirects)
WEBAPP_URL=http://localhost:3001

# ==============================================================================
# DEVELOPMENT
# ==============================================================================

# Enable verbose logging during development
# DEBUG=prpm:*

# Auto-authenticate as a specific user in development mode (no login required)
# Both backend and frontend will auto-authenticate requests for this user
# IMPORTANT: Only works when NODE_ENV=development
# Example: DEV_AUTO_AUTH_USER=khaliqgant
# DEV_AUTO_AUTH_USER=

# Frontend equivalent (Next.js)
# NEXT_PUBLIC_DEV_AUTO_AUTH_USER=khaliqgant

# ==============================================================================
# PRODUCTION NOTES
# ==============================================================================

# For production deployments:
# 1. Generate secure secrets with: openssl rand -base64 32
# 2. Use proper PostgreSQL and Redis instances (not localhost)
# 3. Configure S3 with production credentials
# 4. Set NODE_ENV=production
# 5. Enable AI features with valid ANTHROPIC_API_KEY
# 6. Configure proper GITHUB_CLIENT_ID and GITHUB_CLIENT_SECRET
# 7. Set FRONTEND_URL to your production domain
# 8. Consider using OpenSearch for better search performance
# 9. Adjust RATE_LIMIT_MAX and MAX_PACKAGE_SIZE based on your needs
# 10. Never commit .env to git - keep secrets secure!
